# SonarCloud configuration for Omnia Kubernetes Operator
sonar.projectKey=AltairaLabs_Omnia
sonar.organization=altairalabs

# Project metadata
sonar.projectName=Omnia
sonar.projectVersion=1.0

# Source configuration - Omnia kubebuilder project structure
# Note: pkg/ contains generated protobuf code (*.pb.go) which is excluded from analysis
sonar.sources=api,cmd,internal,pkg
sonar.inclusions=**/*.go
sonar.exclusions=**/*_test.go,**/test_*.go,**/testdata/**,**/vendor/**,**/bin/**,**/docs/**,**/*.md,**/.git/**,**/.vscode/**,**/.scannerwork/**,**/*.pb.go

# Go specific settings
sonar.go.coverage.reportPaths=coverage.out

# Coverage exclusions - exclude from coverage requirements:
# - test utilities (test helpers, not production code)
# - generated files (zz_generated*.go - kubebuilder generated)
# - cmd/main.go (operator entry point with minimal logic)
# - cmd/agent/main.go (agent entry point with minimal logic)
# - cmd/runtime/** (requires local PromptKit dependency, not published yet)
# - internal/runtime/** (requires local PromptKit dependency, not published yet)
# - internal/session/redis.go (requires running Redis for integration tests)
# - internal/agent/metrics.go (uses promauto which registers to global registry)
# - internal/facade/metrics.go (NoOpMetrics has empty function bodies that can't be covered)
#
# Note: The following functions in agentruntime_controller.go have limited coverage:
# - SetupWithManager (0%): kubebuilder scaffolding, tested via controller-runtime
# - reconcileKEDA (0%): requires KEDA CRDs in envtest (tested via E2E)
# The HPA tests now cover reconcileHPA (78.4%) using envtest's built-in HPA support.
sonar.coverage.exclusions=**/test/**,**/zz_generated*.go,cmd/main.go,cmd/agent/main.go,cmd/runtime/**,internal/runtime/**,internal/session/redis.go,internal/agent/metrics.go,internal/facade/metrics.go

# CPD (Copy Paste Detector) exclusions - interface implementations and controller patterns have intentional similarity
sonar.cpd.exclusions=internal/session/redis.go,internal/controller/provider_controller.go

# Issue ignore rules (similar to PromptKit)
# e1: Disable TODO comment rule globally - TODOs are tracked in project management
# e2-e3: Disable godre rules globally
sonar.issue.ignore.multicriteria=e1,e2,e3
sonar.issue.ignore.multicriteria.e1.ruleKey=go:S1135
sonar.issue.ignore.multicriteria.e1.resourceKey=**/*.go
sonar.issue.ignore.multicriteria.e2.ruleKey=godre:S1172
sonar.issue.ignore.multicriteria.e2.resourceKey=**/*.go
sonar.issue.ignore.multicriteria.e3.ruleKey=godre:S8148
sonar.issue.ignore.multicriteria.e3.resourceKey=**/*.go

# Quality gate settings
sonar.qualitygate.wait=true