# SonarCloud configuration for Omnia Kubernetes Operator
sonar.projectKey=AltairaLabs_Omnia
sonar.organization=altairalabs

# Project metadata
sonar.projectName=Omnia
sonar.projectVersion=1.0

# Source configuration - Omnia kubebuilder project structure + Dashboard
# Note: pkg/ contains generated protobuf code (*.pb.go) which is excluded from analysis
sonar.sources=api,cmd,internal,pkg,dashboard/src
sonar.tests=dashboard/src
sonar.test.inclusions=dashboard/src/**/*.test.ts,dashboard/src/**/*.test.tsx
sonar.inclusions=**/*.go,dashboard/src/**/*.ts,dashboard/src/**/*.tsx
sonar.exclusions=**/*_test.go,**/test_*.go,**/testdata/**,**/vendor/**,**/bin/**,**/docs/**,**/*.md,**/.git/**,**/.vscode/**,**/.scannerwork/**,**/*.pb.go,dashboard/src/**/*.test.ts,dashboard/src/**/*.test.tsx,dashboard/node_modules/**,dashboard/.next/**,dashboard/coverage/**

# Go specific settings
sonar.go.coverage.reportPaths=coverage.out

# TypeScript/JavaScript settings (Dashboard)
sonar.typescript.lcov.reportPaths=dashboard/coverage/lcov.info
sonar.javascript.lcov.reportPaths=dashboard/coverage/lcov.info

# Coverage exclusions - exclude from coverage requirements:
# - test utilities (test helpers, not production code)
# - generated files (zz_generated*.go - kubebuilder generated)
# - cmd/main.go (operator entry point with minimal logic)
# - cmd/agent/main.go (agent entry point with minimal logic)
# - cmd/runtime/** (requires local PromptKit dependency, not published yet)
# - internal/runtime/** (requires local PromptKit dependency, not published yet)
# - internal/session/redis.go (requires running Redis for integration tests)
# - internal/agent/metrics.go (uses promauto which registers to global registry)
# - internal/facade/metrics.go (NoOpMetrics has empty function bodies that can't be covered)
# - internal/api/server.go (logs endpoint requires real K8s clientset for integration testing)
# Dashboard exclusions:
# - dashboard/src/test/** (test setup files)
# - dashboard/src/**/*.d.ts (type definition files)
# - dashboard/src/lib/api/schema.d.ts (generated API schema)
# - dashboard/src/**/index.ts (barrel files with re-exports only)
# - dashboard/src/components/ui/** (shadcn components - vendor code)
#
# Note: The following functions in agentruntime_controller.go have limited coverage:
# - SetupWithManager (0%): kubebuilder scaffolding, tested via controller-runtime
# - reconcileKEDA (0%): requires KEDA CRDs in envtest (tested via E2E)
# The HPA tests now cover reconcileHPA (78.4%) using envtest's built-in HPA support.
sonar.coverage.exclusions=**/test/**,**/zz_generated*.go,cmd/main.go,cmd/agent/main.go,cmd/runtime/**,internal/runtime/**,internal/session/redis.go,internal/agent/metrics.go,internal/facade/metrics.go,internal/api/server.go,dashboard/src/test/**,dashboard/src/**/*.d.ts,dashboard/src/**/index.ts,dashboard/src/**/index.tsx,dashboard/src/components/ui/**

# CPD (Copy Paste Detector) exclusions - interface implementations and controller patterns have intentional similarity
# Dashboard OAuth providers have intentional similarity (same interface implementation pattern)
sonar.cpd.exclusions=internal/session/redis.go,internal/controller/provider_controller.go,dashboard/src/lib/auth/oauth/providers/**,dashboard/src/components/ui/**

# Issue ignore rules (similar to PromptKit)
# e1: Disable TODO comment rule globally - TODOs are tracked in project management
# e2-e3: Disable godre rules globally
sonar.issue.ignore.multicriteria=e1,e2,e3
sonar.issue.ignore.multicriteria.e1.ruleKey=go:S1135
sonar.issue.ignore.multicriteria.e1.resourceKey=**/*.go
sonar.issue.ignore.multicriteria.e2.ruleKey=godre:S1172
sonar.issue.ignore.multicriteria.e2.resourceKey=**/*.go
sonar.issue.ignore.multicriteria.e3.ruleKey=godre:S8148
sonar.issue.ignore.multicriteria.e3.resourceKey=**/*.go

# Quality gate settings
sonar.qualitygate.wait=true