# Default values for omnia.
# This is a YAML-formatted file.

# -- Number of operator replicas
replicaCount: 1

image:
  # -- Image repository
  repository: ghcr.io/altairalabs/omnia
  # -- Image pull policy
  pullPolicy: IfNotPresent
  # -- Image tag (defaults to Chart appVersion)
  tag: ""

# -- Image pull secrets
imagePullSecrets: []

# -- Override the name of the chart
nameOverride: ""

# -- Override the full name of the chart
fullnameOverride: ""

serviceAccount:
  # -- Create a service account
  create: true
  # -- Annotations to add to the service account
  annotations: {}
  # -- The name of the service account (generated if not set)
  name: ""

# -- Pod annotations
podAnnotations: {}

# -- Pod security context
podSecurityContext:
  runAsNonRoot: true
  seccompProfile:
    type: RuntimeDefault

# -- Container security context
securityContext:
  readOnlyRootFilesystem: true
  allowPrivilegeEscalation: false
  capabilities:
    drop:
      - ALL

# -- Resource limits and requests
resources:
  limits:
    cpu: 500m
    memory: 128Mi
  requests:
    cpu: 10m
    memory: 64Mi

# -- Node selector
nodeSelector: {}

# -- Tolerations
tolerations: []

# -- Affinity rules
affinity: {}

# Leader election configuration
leaderElection:
  # -- Enable leader election for HA
  enabled: true

# Health probes configuration
probes:
  # -- Port for health probes
  port: 8081
  liveness:
    # -- Initial delay for liveness probe
    initialDelaySeconds: 15
    # -- Period for liveness probe
    periodSeconds: 20
  readiness:
    # -- Initial delay for readiness probe
    initialDelaySeconds: 5
    # -- Period for readiness probe
    periodSeconds: 10

# Metrics configuration
metrics:
  # -- Enable metrics endpoint
  enabled: false
  # -- Port for metrics
  port: 8443
  # -- Enable secure metrics (HTTPS)
  secure: true

# Webhook configuration
webhook:
  # -- Enable webhooks
  enabled: false
  # -- Port for webhooks
  port: 9443

# RBAC configuration
rbac:
  # -- Create RBAC resources
  create: true

# CRD configuration
crds:
  # -- Install CRDs with the chart
  install: true

# Agent container configuration (used by AgentRuntime)
agent:
  image:
    # -- Agent image repository
    repository: ghcr.io/altairalabs/omnia-agent
    # -- Agent image tag (defaults to Chart appVersion)
    tag: ""

# Observability configuration (for Omnia-specific templates)
observability:
  # -- Enable Omnia dashboards/datasources
  enabled: true

# ============================================================================
# Subchart configurations (optional observability stack)
# Set enabled: true to deploy each component
# ============================================================================

# Prometheus configuration (metrics)
# See: https://github.com/prometheus-community/helm-charts/tree/main/charts/prometheus
prometheus:
  # -- Enable Prometheus
  enabled: true
  server:
    # -- Disable persistent storage for dev/test
    persistentVolume:
      enabled: false
  # -- Disable alertmanager
  alertmanager:
    enabled: false
  # -- Disable pushgateway
  prometheus-pushgateway:
    enabled: false
  # -- Disable node-exporter
  prometheus-node-exporter:
    enabled: false
  # -- Disable kube-state-metrics (usually already present)
  kube-state-metrics:
    enabled: false

# Grafana configuration (dashboards)
# See: https://github.com/grafana/helm-charts/tree/main/charts/grafana
grafana:
  # -- Enable Grafana
  enabled: true
  # -- Admin password (change in production!)
  adminPassword: admin
  # Sidecar configuration for auto-loading dashboards/datasources
  sidecar:
    dashboards:
      # -- Enable dashboard sidecar
      enabled: true
      # -- Label to identify dashboard ConfigMaps
      label: grafana_dashboard
      # -- Search all namespaces for dashboards
      searchNamespace: ALL
    datasources:
      # -- Enable datasource sidecar
      enabled: true
      # -- Label to identify datasource ConfigMaps
      label: grafana_datasource
      # -- Search all namespaces for datasources
      searchNamespace: ALL
  # -- Grafana service type
  service:
    type: ClusterIP

# Loki configuration (logs)
# See: https://github.com/grafana/helm-charts/tree/main/charts/loki
loki:
  # -- Enable Loki
  enabled: true
  # -- Deploy in single binary mode
  deploymentMode: SingleBinary
  loki:
    # -- Disable auth for simplicity
    auth_enabled: false
    # -- Use test schema for quick deployment
    useTestSchema: true
    # -- Use filesystem storage
    storage:
      type: filesystem
    # -- Common config for single-binary mode
    commonConfig:
      replication_factor: 1
  singleBinary:
    # -- Single replica for dev/test
    replicas: 1
    persistence:
      # -- Enable persistence for dev/test
      enabled: true
      size: 10Gi
  # -- Disable distributed components
  backend:
    replicas: 0
  read:
    replicas: 0
  write:
    replicas: 0
  # -- Disable gateway
  gateway:
    enabled: false
  # -- Disable caches for simpler deployment
  chunksCache:
    enabled: false
  resultsCache:
    enabled: false

# Tempo configuration (traces)
# See: https://github.com/grafana/helm-charts/tree/main/charts/tempo
tempo:
  # -- Enable Tempo
  enabled: true
  tempo:
    # -- Disable telemetry reporting
    reportingEnabled: false
  # -- Disable persistence for dev/test
  persistence:
    enabled: false
